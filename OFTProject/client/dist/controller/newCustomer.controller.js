sap.ui.define(["oft/fiori/controller/BaseController","sap/m/MessageBox","sap/m/MessageToast","oft/fiori/models/formatter","sap/ui/model/Filter"],function(e,t,s,i,a){"use strict";return e.extend("oft.fiori.controller.newCustomer",{formatter:i,onInit:function(){this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);this.oRouter.attachRoutePatternMatched(this.herculis,this);var e=this.getModel("local").getProperty("/CurrentUser");if(e){var t=this.getModel("local").oData.AppUsers[e].UserName}t="Hey "+t;this.getView().byId("idUser").setText(t)},onBack:function(){sap.ui.getCore().getView().byId("idApp").to("idView1")},herculis:function(e){if(e.getParameter("name")!=="newCustomer"){return}this.getView().getModel("local").setProperty("/newCustomer/GmailId",null);this.getView().getModel("local").setProperty("/newCustomer/Name",null);this.getView().getModel("local").setProperty("/newCustomer/Country","IN");this.getView().getModel("local").setProperty("/newCustomer/ContactNo",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail1",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail2",null);this.getView().getModel("local").setProperty("/newCustomer/Skills",null);this.getView().getModel("local").setProperty("/newCustomer/Address","");this.getView().getModel("local").setProperty("/newCustomer/City","");this.getView().getModel("local").setProperty("/newCustomer/GSTIN","");this.getView().getModel("local").setProperty("/newCustomer/GSTCharge",false);this.getView().getModel("local").setProperty("/newCustomer/Company",false);this.getView().getModel("local").setProperty("/newCustomer/Star",false);this.getView().getModel("local").setProperty("/newCustomer/Defaulter",false);this.getView().getModel("local").setProperty("/newCustomer/HighServerUsage",false);this.getView().byId("idSkills1").clearSelection();this.getView().byId("createNew1").setText("Create");this.UpdateCustomer=false;this.customerGUID=null},onReplicateOneStudent:function(){var e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(e.test(this.vEmail)){$.post("/replicateOneStudentToStudentPortal",{mailId:this.vEmail}).done(function(e,i){s.show(t.success(JSON.stringify(e)));that.getView().byId("idReplicateOneStudent").setEnabled(true)}).fail(function(e,s,i){t.error("Error in access");that.getView().byId("idReplicateOneStudent").setEnabled(true)})}else{sap.m.MessageToast.show("Invalid email id");return""}},onReplicateStudents:function(){var e=this;t.confirm("are you sure?",function(i){if(i==="OK"){e.getView().byId("idReplicateStudents").setEnabled(false);s.show("Replication started, Please Wait...");$.get("/replicateStudentsToStudentPortal").done(function(s,i){t.success(JSON.stringify(s));e.getView().byId("idReplicateStudents").setEnabled(true)}).fail(function(s,i,a){e.getView().byId("idReplicateStudents").setEnabled(true);t.error("Error in access")})}})},onSelect:function(e){this.sId=e.getSource().getId();var t="",s="";if(this.sId.indexOf("customerId")!==-1){this.getCustomerPopup();var i=this.getView().getModel("i18n").getProperty("customer");this.searchPopup.setTitle(i);this.searchPopup.bindAggregation("items",{path:"/Students",template:new sap.m.DisplayListItem({label:"{Name}",value:"{GmailId}"})})}else if(this.sId.indexOf("idEmailCust1")!==-1){this.getCustomerPopup();var i=this.getView().getModel("i18n").getProperty("customer");this.searchPopup.setTitle(i);this.searchPopup.bindAggregation("items",{path:"/Inquries",template:new sap.m.DisplayListItem({label:"{EmailId}",value:"{FirstName}"})})}},onConfirm:function(e){if(this.sId.indexOf("customerId")!==-1){var t=this.getSelectedKey(e);this.getView().byId("customerId").setValue(t[0]);this.customerId=t[2]}else if(this.sId.indexOf("idEmailCust1")!==-1){debugger;var s=e.getParameter("selectedItem");var i=s.getBindingContext();if(i){var a=this;var l={};var r=new sap.ui.model.Filter("GmailId","EQ",i.getObject().EmailId);this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[r]},l,this).then(function(e){if(e.results.length!=0){a.getView().byId("idEmailCust1").setValue(e.results[0].GmailId);a.getView().byId("idName1").setValue(e.results[0].Name);if(e.results[0].ContactNo){a.getView().byId("idPhone1").setValue(e.results[0].ContactNo)}else{a.getView().byId("idPhone1").setValue(0)}if(e.results[0].Country){a.getView().byId("idCountry1").setSelectedKey(e.results[0].Country)}else{a.getView().byId("idCountry1").setSelectedKey("IN")}if(e.results[0].OtherEmail1){a.getView().byId("idOtherEmail11").setValue(e.results[0].OtherEmail1)}if(e.results[0].OtherEmail2){a.getView().byId("idOtherEmail21").setValue(e.results[0].OtherEmail2)}a.getView().byId("idDefaulter1").setSelected(e.results[0].Defaulter);a.getView().byId("idHighServerUsage1").setSelected(e.results[0].HighServerUsage);a.getView().byId("idStar1").setSelected(e.results[0].Star);a.getView().byId("createNew1").setText("Update");a.UpdateCustomer=true;a.customerGUID=e.results[0].id}else{var t;var s;a.getView().byId("idEmailCust1").setValue(i.getObject().EmailId);if(i.getObject().FirstName){if(i.getObject().LastName){t=i.getObject().LastName}else{t=" "}a.getView().byId("idName1").setValue(i.getObject().FirstName+" "+t)}else{s="";if(i.getObject().LastName){t=i.getObject().LastName}else{t=""}a.getView().byId("idName1").setValue(s+" "+t)}if(i.getObject().Phone){a.getView().byId("idPhone1").setValue(i.getObject().Phone)}else{a.getView().byId("idPhone1").setValue(0)}if(i.getObject().Country){a.getView().byId("idCountry1").setSelectedKey(i.getObject().Country)}else{a.getView().byId("idCountry1").setSelectedKey("IN")}a.getView().byId("createNew1").setText("Create");a.UpdateCustomer=false}}).catch(function(e){var t;var s;a.getView().byId("idEmailCust1").setValue(i.getObject().EmailId);if(i.getObject().FirstName){if(i.getObject().LastName){t=i.getObject().LastName}else{t=" "}a.getView().byId("idName1").setValue(i.getObject().FirstName+" "+t)}else{s="";if(i.getObject().LastName){t=i.getObject().LastName}else{t=""}a.getView().byId("idName1").setValue(s+" "+t)}if(i.getObject().Phone){a.getView().byId("idPhone1").setValue(i.getObject().Phone)}else{a.getView().byId("idPhone1").setValue(0)}if(i.getObject().Country){a.getView().byId("idCountry1").setSelectedKey(i.getObject().Country)}else{a.getView().byId("idCountry1").setSelectedKey("IN")}a.getView().byId("createNew1").setText("Create");a.UpdateCustomer=false})}}},suggestionItemSelected:function(e){debugger;var t=e.getParameter("selectedItem");var s=t.getBindingContext();if(s){var i=this;var a={};var l=new sap.ui.model.Filter("GmailId","EQ",s.getObject().EmailId);var r=new sap.ui.model.Filter("OtherEmail1","EQ",i.vEmail);var o=new sap.ui.model.Filter("OtherEmail2","EQ",i.vEmail);var n=new sap.ui.model.Filter({filters:[l,r,o],and:false});debugger;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[n]},a,this).then(function(e){if(e.results.length!=0){i.getView().byId("idEmailCust1").setValue(e.results[0].GmailId);i.getView().byId("idName1").setValue(e.results[0].Name);if(e.results[0].ContactNo){i.getView().byId("idPhone1").setValue(e.results[0].ContactNo)}else{i.getView().byId("idPhone1").setValue(0)}if(e.results[0].Country){i.getView().byId("idCountry1").setSelectedKey(e.results[0].Country)}else{i.getView().byId("idCountry1").setSelectedKey("IN")}if(e.results[0].OtherEmail1){i.getView().byId("idOtherEmail11").setValue(e.results[0].OtherEmail1)}if(e.results[0].OtherEmail2){i.getView().byId("idOtherEmail21").setValue(e.results[0].OtherEmail2)}i.getView().byId("idDefaulter1").setSelected(e.results[0].Defaulter);i.getView().byId("idHighServerUsage1").setSelected(e.results[0].HighServerUsage);i.getView().byId("idStar1").setSelected(e.results[0].Star);i.getView().byId("createNew1").setText("Update");i.UpdateCustomer=true;i.customerGUID=e.results[0].id}else{var t;var a;i.getView().byId("idEmailCust1").setValue(s.getObject().EmailId);if(s.getObject().FirstName){if(s.getObject().LastName){t=s.getObject().LastName}else{t=" "}i.getView().byId("idName1").setValue(s.getObject().FirstName+" "+t)}else{a="";if(s.getObject().LastName){t=s.getObject().LastName}else{t=""}i.getView().byId("idName1").setValue(a+" "+t)}if(s.getObject().Phone){i.getView().byId("idPhone1").setValue(s.getObject().Phone)}else{i.getView().byId("idPhone1").setValue(0)}if(s.getObject().Country){i.getView().byId("idCountry1").setSelectedKey(s.getObject().Country)}else{i.getView().byId("idCountry1").setSelectedKey("IN")}i.getView().byId("createNew1").setText("Create");i.UpdateCustomer=false}}).catch(function(e){var t;var a;i.getView().byId("idEmailCust1").setValue(s.getObject().EmailId);if(s.getObject().FirstName){if(s.getObject().LastName){t=s.getObject().LastName}else{t=" "}i.getView().byId("idName1").setValue(s.getObject().FirstName+" "+t)}else{a="";if(s.getObject().LastName){t=s.getObject().LastName}else{t=""}i.getView().byId("idName1").setValue(a+" "+t)}if(s.getObject().Phone){i.getView().byId("idPhone1").setValue(s.getObject().Phone)}else{i.getView().byId("idPhone1").setValue(0)}if(s.getObject().Country){i.getView().byId("idCountry1").setSelectedKey(s.getObject().Country)}else{i.getView().byId("idCountry1").setSelectedKey("IN")}i.getView().byId("createNew1").setText("Create");i.UpdateCustomer=false})}},onSearch:function(e){if(this.sId.indexOf("customerId")!==-1){var t=this.getQuery(e);if(t){var s=new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter("GmailId",sap.ui.model.FilterOperator.Contains,t);var a=new sap.ui.model.Filter({filters:[s,i],and:false});var l=[a];this.searchPopup.getBinding("items").filter(l)}else{this.searchPopup.bindAggregation("items",{path:"/Students",template:new sap.m.DisplayListItem({label:"{Name}",value:"{GmailId}"})});this.searchPopup.getBinding("items").filter([])}}},onCancel:function(e){},onClose:function(){},onCreateCust:function(e){var t=e;var s=this;s.getView().setBusy(true);var i=this.getView().getModel("local").getProperty("/newCustomer");debugger;if(s.UpdateCustomer==false){if(i.OtherEmail1){i.OtherEmail1=i.OtherEmail1.toLowerCase()}if(i.OtherEmail2){i.OtherEmail2=i.OtherEmail2.toLowerCase()}var a={GmailId:i.GmailId.toLowerCase(),Name:i.Name,CompanyMail:i.CompanyMail,Country:i.Country,Designation:i.Designation,OtherEmail1:i.OtherEmail1,OtherEmail2:i.OtherEmail2,ContactNo:i.ContactNo,Star:i.Star,Defaulter:i.Defaulter,HighServerUsage:i.HighServerUsage,Skills:i.Skills,Resume:this.FileContent,Address:i.Address,City:i.City,GSTIN:i.GSTIN,GSTCharge:i.GSTCharge,Company:i.Company,Extra1:"EExtra1",Extra2:"EExtra2",CreatedOn:new Date,CreatedBy:"DemoUser"};debugger;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","POST",{},a,this).then(function(e){debugger;s.getView().setBusy(false);sap.m.MessageToast.show("Customer Saved successfully");s.destroyMessagePopover()}).catch(function(e){debugger;s.getView().setBusy(false);var t=s.getErrorMessage(e)})}else{debugger;var l=" ";if(i.Star==true){l="true"}else{l="false"}var r=" ";if(i.Defaulter==true){r="true"}else{r="false"}var o=" ";if(i.HighServerUsage==true){o="true"}else{o="false"}var a={GmailId:i.GmailId,Name:i.Name,CompanyMail:i.CompanyMail,Country:i.Country,Designation:i.Designation,OtherEmail1:i.OtherEmail1,OtherEmail2:i.OtherEmail2,ContactNo:i.ContactNo,Star:l,Defaulter:r,HighServerUsage:o,Skills:i.Skills,Resume:this.FileContent,Address:i.Address,City:i.City,GSTIN:i.GSTIN,GSTCharge:i.GSTCharge,Company:i.Company,Extra1:"EExtra1",Extra2:"EExtra2",ChangedOn:new Date,ChangedBy:"DemoUser"};debugger;var n="/Students";n=n+"("+"'"+s.customerGUID+"'"+")";this.ODataHelper.callOData(this.getOwnerComponent().getModel(),n,"PUT",{},a,this).then(function(e){debugger;s.getView().setBusy(false);sap.m.MessageToast.show("Customer updated successfully");s.destroyMessagePopover()}).catch(function(e){debugger;s.getView().setBusy(false);var t=s.getErrorMessage(e)})}},onLiveSearch:function(e){debugger;var t=e.getParameter("query");if(!t){t=e.getParameter("value")}if(this.sId.indexOf("customerId")!==-1){if(t){var s=new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter("GmailId",sap.ui.model.FilterOperator.Contains,t);var a=new sap.ui.model.Filter({filters:[s,i],and:false});var l=[a];this.searchPopup.getBinding("items").filter(l)}else{this.searchPopup.bindAggregation("items",{path:"/Students",template:new sap.m.DisplayListItem({label:"{Name}",value:"{GmailId}"})});this.searchPopup.getBinding("items").filter([])}}else if(this.sId.indexOf("idEmailCust1")!==-1){if(t){var s=new sap.ui.model.Filter("EmailId",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter("FirstName",sap.ui.model.FilterOperator.Contains,t);var a=new sap.ui.model.Filter({filters:[s,i],and:false});var l=[a];this.searchPopup.getBinding("items").filter(l)}else{this.searchPopup.bindAggregation("items",{path:"/Inquries",template:new sap.m.DisplayListItem({label:"{EmailId}",value:"{FirstName}"})});this.searchPopup.getBinding("items").filter([])}}},onClearScreen:function(e){debugger;this.getView().getModel("local").setProperty("/newCustomer/GmailId",null);this.getView().getModel("local").setProperty("/newCustomer/Name",null);this.getView().getModel("local").setProperty("/newCustomer/Country","IN");this.getView().getModel("local").setProperty("/newCustomer/ContactNo",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail1",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail2",null);this.getView().getModel("local").setProperty("/newCustomer/Skills",null);this.getView().getModel("local").setProperty("/newCustomer/Star",false);this.getView().getModel("local").setProperty("/newCustomer/Defaulter",false);this.getView().getModel("local").setProperty("/newCustomer/HighServerUsage",false);this.getView().getModel("local").setProperty("/newCustomer/Address","");this.getView().getModel("local").setProperty("/newCustomer/City","");this.getView().getModel("local").setProperty("/newCustomer/GSTIN","");this.getView().getModel("local").setProperty("/newCustomer/GSTCharge",false);this.getView().getModel("local").setProperty("/newCustomer/Company","");this.getView().byId("idSkills1").clearSelection();this.getView().byId("createNew1").setText("Create");this.getView().byId("idSubs").destroyItems();this.getView().byId("idServer").destroyItems();this.getView().byId("idInquiries").destroyItems();this.UpdateCustomer=false;this.customerGUID=null},handleSkillChange:function(e){},handleSkillFinish:function(e){var t=e.getParameter("selectedItems");debugger;var s=" ";for(var i=0;i<t.length;i++){s+=t[i].getText();if(i!=t.length-1){s+=","}}this.getView().getModel("local").setProperty("/newCustomer/Skills",s)},onEmail:function(e){this.getView().byId("idName1").setEnabled(true)},onEmailExist:function(e){var t=e;var s=this;e.getSource().setValue(e.getParameter("value").toLowerCase().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "));var i=this.getView().getModel("local").getProperty("/newCustomer");var a={};if(i.GmailId){var l=new sap.ui.model.Filter("GmailId","EQ",i.GmailId);debugger;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[l]},a,this).then(function(e){if(e.results.length!=0){s.getView().byId("createNew1").setText("Update");s.UpdateCustomer=true;s.customerGUID=e.results[0].id;sap.m.MessageToast.show("Email Exists. Use F4 help or Use suggestion on Email field to fetch values")}else{s.getView().byId("createNew1").setText("Create");s.UpdateCustomer=false}}).catch(function(e){debugger;sap.m.MessageToast.show("New Customer");s.getView().byId("createNew1").setText("Create");s.UpdateCustomer=false})}else{this.getView().byId("idName1").setEnabled(false);sap.m.MessageToast.show("Enter/select email id first")}},onDataExport:function(e){$.ajax({type:"GET",url:"StudentDownload",success:function(e){sap.m.MessageToast.show("File Downloaded succesfully user->AppData->local->Temp")},error:function(e,t,s){sap.m.MessageToast.show("error in downloading the excel file")}})},onEnter:function(e){e.getSource().setValue(e.getParameter("value").replace(/\s/gm,"").toLowerCase());this.getView().byId("idDelete").setEnabled(false);this.vEmail=e.getParameters().value;var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(t.test(this.vEmail)){var s=this;var i={};var a=new sap.ui.model.Filter("GmailId","EQ",s.vEmail);var l=new sap.ui.model.Filter("OtherEmail1","EQ",s.vEmail);var r=new sap.ui.model.Filter("OtherEmail2","EQ",s.vEmail);var o=new sap.ui.model.Filter({filters:[a,l,r],and:false});debugger;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[o]},i,this).then(function(e){if(e.results.length!=0){s.getView().byId("idEmailCust1").setValue(e.results[0].GmailId);s.getView().byId("idName1").setValue(e.results[0].Name);s.getView().getModel("local").setProperty("/newCustomer",e.results[0]);if(e.results[0].ContactNo){s.getView().byId("idPhone1").setValue(e.results[0].ContactNo)}else{s.getView().byId("idPhone1").setValue(0)}if(e.results[0].Country){s.getView().byId("idCountry1").setSelectedKey(e.results[0].Country)}else{s.getView().byId("idCountry1").setSelectedKey("IN")}if(e.results[0].OtherEmail1){s.getView().byId("idOtherEmail11").setValue(e.results[0].OtherEmail1)}if(e.results[0].OtherEmail2){s.getView().byId("idOtherEmail21").setValue(e.results[0].OtherEmail2)}s.getView().byId("idDefaulter1").setSelected(e.results[0].Defaulter);s.getView().byId("idHighServerUsage1").setSelected(e.results[0].HighServerUsage);s.getView().byId("idStar1").setSelected(e.results[0].Star);s.getView().byId("createNew1").setText("Update");s.UpdateCustomer=true;s.customerGUID=e.results[0].id;var t=s;s.ODataHelper.callOData(s.getOwnerComponent().getModel(),"/Students('"+e.results[0].id+"')/Subscriptions","GET",{},r,s).then(function(e){var i=t;if(e.results.length==0){t.getView().byId("idDelete").setEnabled(true)}else{t.getView().byId("idDelete").setEnabled(false)}for(var a=0;a<e.results.length;a++){t.ODataHelper.callOData(s.getOwnerComponent().getModel(),"/Courses('"+e.results[a].CourseId+"')","GET",{},r,t).then(function(e){var t=i.getView().getModel("local").getProperty("/AllSubs");for(var s=0;s<t.length;s++){if(t[s].CourseId===e.id){t[s].CourseId=e.BatchNo}}i.getView().getModel("local").setProperty("/AllSubs",t)})}t.getView().getModel("local").setProperty("/AllSubs",e.results)});s.ODataHelper.callOData(s.getOwnerComponent().getModel(),"/Students('"+e.results[0].id+"')/Servers","GET",{},r,s).then(function(e){if(e.results.length==0){t.getView().byId("idDelete").setEnabled(true)}else{t.getView().byId("idDelete").setEnabled(false)}t.getView().getModel("local").setProperty("/AllServer",e.results);t.getView().byId("idServer").bindItems({path:"local>/AllServer",template:new sap.m.DisplayListItem({label:"{local>User}",value:"{local>EndDate}"})});console.log(e)});var i=new sap.ui.model.Filter("EmailId","EQ",e.results[0].GmailId);s.ODataHelper.callOData(s.getOwnerComponent().getModel(),"/Inquries","GET",{filters:[i]},r,s).then(function(e){t.getView().getModel("local").setProperty("/AllInquiries",e.results);t.getView().byId("idInquiries").bindItems({path:"local>/AllInquiries",template:new sap.m.DisplayListItem({label:"{local>EmailId}",value:"{local>CourseName}"})})})}else{var a;var l;var t=s;var r={};var i=new sap.ui.model.Filter("EmailId","EQ",s.vEmail);debugger;s.ODataHelper.callOData(s.getOwnerComponent().getModel(),"/Inquries","GET",{filters:[i]},r,s).then(function(e){if(e.results.length!=0){t.getView().byId("idEmailCust1").setValue(e.results[0].EmailId);t.getView().byId("idName1").setValue(e.results[0].Name);if(e.results[0].FirstName){if(e.results[0].LastName){a=e.results[0].LastName}else{a=" "}t.getView().byId("idName1").setValue(e.results[0].FirstName+" "+a)}else{l="";if(e.results[0].LastName){a=e.results[0].LastName}else{a=""}t.getView().byId("idName1").setValue(l+" "+a)}if(e.results[0].Phone){t.getView().byId("idPhone1").setValue(e.results[0].Phone)}else{t.getView().byId("idPhone1").setValue(0)}if(e.results[0].Country){t.getView().byId("idCountry1").setSelectedKey(e.results[0].Country)}else{t.getView().byId("idCountry1").setSelectedKey("IN")}t.getView().byId("createNew1").setText("Create");t.UpdateCustomer=false}else{t.getView().byId("createNew1").setText("Create");t.UpdateCustomer=false}}).catch(function(e){var s=t.getErrorMessage(e)})}}).catch(function(e){var t=s.getErrorMessage(e)})}else{sap.m.MessageToast.show("Invalid email id");return""}},onDeleteCust:function(e){var s=this;s.getView().setBusy(true);var i=new sap.ui.model.Filter("StudentId","EQ","'"+s.customerGUID+"'");s.ODataHelper.callOData(s.getOwnerComponent().getModel(),"/Subs","GET",{filters:[i]},{},s).then(function(e){if(e.results.length<1){t.confirm("Do you want to delete the selected records?",function(e){if(e=="OK"){var t="/Students('"+s.customerGUID+"')";s.ODataHelper.callOData(s.getOwnerComponent().getModel(),t,"DELETE",{},{},s).then(function(e){s.getView().byId("idDelete").setEnabled(false);s.getView().setBusy(false);sap.m.MessageToast.show("Deleted succesfully")}).catch(function(e){s.getView().setBusy(false);s.oPopover=s.getErrorMessage(e)})}},"Confirmation")}else{s.getView().setBusy(false);sap.m.MessageToast.show(e.results.length+" Subscription found, can't delete")}}).catch(function(e){s.getView().setBusy(false);s.oPopover=s.getErrorMessage(e)})}})});