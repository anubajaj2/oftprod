var courseGUID;var customerGUID;var vEmail;var CourseFee;sap.ui.define(["oft/fiori/controller/BaseController","sap/m/MessageBox","sap/m/MessageToast","oft/fiori/models/formatter","sap/ui/model/Filter","sap/m/Token","sap/ui/model/FilterOperator"],function(Controller,MessageBox,MessageToast,Formatter,oFilter,oToken,FilterOperator){"use strict";return Controller.extend("oft.fiori.controller.newReg",{formatter:Formatter,fnOnUpLoadFile:function(e){var t=this.getView().byId("imageUploader");var a=t.getFocusDomRef();var s=a.files[0];var i=this;if(s){var i=this;this.fileName=s.name;this.fileType=s.type;var r=new FileReader;r.onload=function(e){i.imgContent=e.currentTarget.result};r.readAsDataURL(s)}},handleTypeMissmatch:function(e){var t=e.getSource().getFileType();jQuery.each(t,function(e,a){t[e]="*."+a});var a=t.join(", ");MessageToast.show("The file type *."+e.getParameter("fileType")+" is not supported. Choose one of the following types: "+a)},handleSizeExceed:function(e){var t=e.getSource().getMaximumFileSize();MessageToast.show("Maximun file size allowed is "+t+" MB")},onReplicateOneSub:function(){var e=this;const t=this.getView().byId("idCourseId").getValue();const a=this.getView().byId("batch").getValue();var s={Name:a,BatchNo:t};if(t&&a){MessageBox.confirm("are you sure?",function(t){if(t==="OK"){e.getView().byId("idReplicateBatches").setEnabled(false);MessageToast.show("Replication started, Please Wait...");$.post("/replicateOneSubToStudentPortal",s).done(function(t,a){MessageBox.success(JSON.stringify(t));e.getView().byId("idReplicateBatches").setEnabled(true)}).fail(function(t,a,s){e.getView().byId("idReplicateBatches").setEnabled(true);MessageBox.error("Error in access")})}})}else{MessageToast.show("Please select a subscription")}},onScreenShot:function(e){var t=this;var a=e.getSource().getBindingContext().sPath;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),a,"GET",{},{},this).then(function(e){var t=e.PaymentScreenshot;var a=new sap.m.Dialog({title:"Payment Screen Shot"});a.addButton(new sap.m.Button({text:"OK",press:function(){a.close();a.destroyContent()}}));var s=new sap.m.Carousel({loop:true});var i=new sap.m.Image({src:t,alt:"",densityAware:true,decorative:false});s.addPage(i);a.addContent(s);a.open()}).catch(function(e){var a=t.getErrorMessage(e)})},onInit:function(){this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);this.totalCount=0;var e=this.getModel("local").getProperty("/CurrentUser");if(e){var t=this.getModel("local").oData.AppUsers[e].UserName}t="Hey "+t;this.getView().byId("idUser").setText(t);this.UserRole=this.getOwnerComponent().getModel("local").getProperty("/Role");var a=this.getOwnerComponent().getModel();var s=new sap.ui.model.json.JSONModel;a.read("/Students",{success:function(e,t){s.setData(e)},error:function(e){}});var i=this.getOwnerComponent().getModel();i.read("/Courses",{success:function(e,t){s.setData(e)},error:function(e){}});this.oRouter.attachRoutePatternMatched(this.herculis,this)},onBack:function(){sap.ui.getCore().byId("idApp").to("idView1")},siteLink:"",eMailId:"",onGiveAccess2:function(e){var t=this;var a=t.getView().byId("idSubsRecent").getSelectedContexts();for(var s=0;s<a["length"];s++){var i=a[s].getModel().getProperty(a[s].getPath());$.post("/giveAccessNew",i).done(function(e,t){MessageToast.show("Access has been provided")}).fail(function(e,t,a){MessageBox.error("Error in access")})}},onGiveAccess:function(e){var t=this;var a=t.getView().byId("idSubsRecent").getSelectedContexts();for(var s=0;s<a["length"];s++){var i=a[s].getModel().getProperty(a[s].getPath());debugger;$.post("/giveAccess",i).done(function(e,t){sap.m.MessageToast.show("Access has been provided")}).fail(function(e,t,a){sap.m.MessageBox.error("Error in access")})}},onAddMember:function(e){var t=this;var a=t.getView().byId("idSubsRecent").getSelectedContexts();for(var s=0;s<a["length"];s++){var i=a[s].getModel().getProperty(a[s].getPath());debugger;t.ODataHelper.callOData(t.getOwnerComponent().getModel(),"/Courses('"+i.CourseId+"')","GET",{},{},t).then(function(e){var t="https://manage.wix.com/dashboard/5364c41b-ca7d-4184-9aec-39408726278b/member-permissions/roles/"+e.RoleId;window.open(t)})}},onClearToken:function(){$.post("/clearToken").done(function(e,t){sap.m.MessageToast.show("Token is now reset")}).fail(function(e,t,a){sap.m.MessageBox.error("Error in access")})},onSendEmail:function(e){var t=this;var a=t.getView().byId("idSubsRecent").getSelectedContexts();for(var s=0;s<a["length"];s++){var i=a[s].getModel().getProperty(a[s].getPath());debugger;var t=this;var r={Status:"Access Granted"};i.password="";i.includeX=t.getView().byId("includeX").getSelected();i.Member=t.getView().byId("idSubsRecent").getSelectedItems()[s].getCells()[8].getProperty("state");$.post("/sendSubscriptionEmail",i).done(function(e,t){sap.m.MessageToast.show("Email sent successfully")}).fail(function(e,a,s){t.passwords="";sap.m.MessageBox.error(e.responseText)})}},oSuppPopup:null,destoryDialog:function(){this.oSuppPopup.destroy();this.oSuppPopup=null},onItemPress:function(e){if(!this.oSuppPopup){this.oSuppPopup=new sap.ui.xmlfragment("oft.fiori.fragments.subSearch",this);sap.ui.getCore().getMessageManager().registerObject(this.oSuppPopup,true);this.getView().addDependent(this.oSuppPopup)}sap.ui.getCore().byId("updPay").setVisible(false);sap.ui.getCore().byId("idPortSubs").setVisible(false);sap.ui.getCore().byId("idExtendSubs").setVisible(false);var t=e.getSource().oBindingContexts.undefined.sPath;t=t.split("/")[1];var a=this.getView().getModel().oData[t];sap.ui.getCore().byId("idCourse_upd").setEnabled(false);sap.ui.getCore().byId("idPayDate_upd").setEnabled(false);sap.ui.getCore().byId("idEndDate_upd").setEnabled(false);sap.ui.getCore().byId("paymentMode_upd").setEnabled(false);sap.ui.getCore().byId("accountDetails_upd").setEnabled(false);sap.ui.getCore().byId("idAmount_upd").setEnabled(false);sap.ui.getCore().byId("idAmount_Txt").setText("Amount");sap.ui.getCore().byId("idReference_upd").setEnabled(false);sap.ui.getCore().byId("idRemarks_upd").setEnabled(false);sap.ui.getCore().byId("idPendingAmount_upd").setEnabled(false);sap.ui.getCore().byId("idPayDueDate_upd").setEnabled(false);this.customerEmail=e.getSource().mAggregations.cells[0].mProperties.text;this.courseName=e.getSource().mAggregations.cells[1].mProperties.text;this.prevPendingAmiount=a.PendingAmount;this.getView().getModel("local").setProperty("/newRegistration/StudentId",this.customerEmail);this.getView().getModel("local").setProperty("/newRegistration/CourseId",this.courseName);this.getView().getModel("local").setProperty("/newRegistration/PaymentMode",a.PaymentMode);this.getView().getModel("local").setProperty("/newRegistration/AccountName",a.AccountName);this.getView().getModel("local").setProperty("/BeneficiaryName",this.getAccountBeneficiary(a.AccountName));this.getView().getModel("local").setProperty("/newRegistration/Amount",a.Amount);this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",a.PendingAmount);this.getView().getModel("local").setProperty("/newRegistration/Reference",a.Reference);this.getView().getModel("local").setProperty("/newRegistration/Remarks",a.Remarks);this.getView().getModel("local").setProperty("/newRegistration/USDAmount",a.USDAmount);this.getView().getModel("local").setProperty("/newRegistration/Charges",a.Charges);this.getView().getModel("local").setProperty("/newRegistration/Exchange",a.Exchange);this.getView().getModel("local").setProperty("/newRegistration/SettleAmount",a.SettleAmount);this.oSuppPopup.open()},onDelete:function(e){var t=this;MessageBox.confirm("Do you want to delete the selected records?",function(e){if(e=="OK"){var a=t.getView().byId("idSubsRecent").getSelectedContexts();for(var s=0;s<a["length"];s++){t.ODataHelper.callOData(t.getOwnerComponent().getModel(),a[s].sPath,"DELETE",{},{},t).then(function(e){sap.m.MessageToast.show("Deleted succesfully")}).catch(function(e){t.getView().setBusy(false);t.oPopover=t.getErrorMessage(e);t.getView().setBusy(false)})}}},"Confirmation")},onRefresh:function(){var e=this.getView().byId("idPayDate");var t=e._lastValue.split(".");var a=new Date(t[2],t[1]-1,t[0]);a.setHours(0,0,0,0);var s=new sap.ui.model.Sorter("CreatedOn",true);var i=new sap.ui.model.Filter("PaymentDate","GE",a);var r=this.getView().byId("idSubsRecent");var o=r.getItems();r.getBinding("items").filter(i);r.getBinding("items").sort(s)},onRate:function(e){this.oEvent_approve=e;var t=e.getSource().getBindingContext().sPath;var a=this;if(e.getSource().getValue()===0){var s={ExtraN1:""}}else{var s={ExtraN1:e.getSource().getValue()}}this.ODataHelper.callOData(this.getOwnerComponent().getModel(),t,"PUT",{},s,this).then(function(e){sap.m.MessageToast.show("Star mark success")}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})},onMemberStateChange:function(e){var t=e.getSource().getBindingContext().sPath;var a=this;var s={Member:e.getParameter("state")};this.ODataHelper.callOData(this.getOwnerComponent().getModel(),t,"PUT",{},s,this).then(function(e){sap.m.MessageToast.show("State Modified");a.onRefresh()}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})},onUSDAmountChange:function(e){var t=e.getParameter("value");var a=t>0?((t*.044+.3)*1.18).toFixed(2):0;var s=this.getView().getModel("local").getProperty("/newRegistration/Exchange");this.getView().getModel("local").setProperty("/newRegistration/Charges",a);this.getView().getModel("local").setProperty("/newRegistration/SettleAmount",((t-a)*s).toFixed(2));this.getView().getModel("local").setProperty("/newRegistration/Amount",(t*s).toFixed(2))},onChargesChange:function(e){var t=e.getParameter("value");var a=this.getView().getModel("local").getProperty("/newRegistration/USDAmount");var s=this.getView().getModel("local").getProperty("/newRegistration/Exchange");this.getView().getModel("local").setProperty("/newRegistration/Charges",t);this.getView().getModel("local").setProperty("/newRegistration/SettleAmount",((a-t)*s).toFixed(2))},onExchangeChange:function(e){var t=e.getParameter("value");var a=this.getView().getModel("local").getProperty("/newRegistration/Charges");var s=this.getView().getModel("local").getProperty("/newRegistration/USDAmount");this.getView().getModel("local").setProperty("/newRegistration/Charges",a);this.getView().getModel("local").setProperty("/newRegistration/SettleAmount",((s-a)*t).toFixed(2));this.getView().getModel("local").setProperty("/newRegistration/Amount",(s*t).toFixed(2))},onSaveSubs:function(e){this.subsciptionSaved="false";var t=e;var a=this;var s=this.getView().getModel("local").getProperty("/newRegistration");var i=false;if(this.getView().byId("idPayDate").getDateValue()){i=this.formatter.getDateCheck(this.getView().byId("idPayDate").getDateValue());if(i==true){sap.m.MessageToast.show("Payment Date can't be in future");return""}}if(this.getView().byId("idRegDate").getDateValue()){i=false;i=this.formatter.getDateCheck(this.getView().byId("idRegDate").getDateValue());if(i==true){sap.m.MessageToast.show("Registration Date can't be in future");return""}}if(this.getView().byId("paymentMode").getSelectedKey()==="PAYPAL"&&this.getView().byId("idUSDAmount").getValue()<1){MessageBox.alert("USD Amount can't be 0 / less than 0");return""}if(!this.getView().byId("idAmount").getValue()||this.getView().byId("idAmount").getValue()<=0){if(this.getView().byId("idAmount").getValue()==0){if(this.getView().byId("idWaiver").getSelected()==false){if(this.getView().byId("idPartPay").getSelected()==false){sap.m.MessageToast.show("Amount can't be 0, if waiver/partial payment not applied");return""}}}else if(this.getView().byId("idAmount").getValue()<0){sap.m.MessageToast.show("Amount can't be less than 0");return""}}if(this.getView().byId("idPendingAmount").getValue()<0){sap.m.MessageToast.show("Pending Amount can't be less than 0");return""}else if(this.getView().byId("idPendingAmount").getValue()>0){if(this.getView().byId("idPartPay").getSelected()==false){sap.m.MessageToast.show('Please check "Partial Payment" flag as Pending Amount is there');return""}}else if(this.getView().byId("idPendingAmount").getValue()==0){if(this.getView().byId("idPartPay").getSelected()==true){sap.m.MessageToast.show('Please uncheck "Partial Payment" flag as Pending Amount is 0');return""}}if(this.getView().byId("idPayDueDate").getDateValue()){var r=this.getView().byId("idPayDueDate").getValue().split(".");var o=this.getView().byId("idPayDate").getValue().split(".");o=o[2]+o[1]+o[0];r=r[2]+r[1]+r[0];if(o>r){sap.m.MessageToast.show("Payment Due Date can't be less than Payment Date");return""}}var l=this.getView().byId("idInterested").getSelected();if(l==true){s.ExtraN1=1}else{s.ExtraN1=0}var n=null;if(this.UserRole=="Admin"||this.getModel("local").getData().CurrentUser==="5c187036dba2681834ffe305"){n="Approved"}else{n="Pending"}var g={StudentId:this.customerId,CourseId:this.courseId,PaymentDate:this.getView().byId("idPayDate").getDateValue(),Mode:s.Mode,StartDate:this.getView().byId("idRegDate").getDateValue(),EndDate:this.getView().byId("idRegEndDate").getDateValue(),PaymentMode:s.PaymentMode,BankName:s.BankName,AccountName:s.AccountName,Amount:s.Amount,Reference:s.Reference,Remarks:s.Remarks,PendingAmount:s.PendingAmount,Waiver:s.Waiver,PartialPayment:s.PartialPayment,PaymentDueDate:this.getView().byId("idPayDueDate").getDateValue(),PaymentScreenshot:this.imgContent,CreatedOn:new Date,CreatedBy:"DemoUser",ChangedOn:new Date,ChangedBy:"DemoUser",DropOut:false,Extra1:" ",Extra2:s.Extra2,ExtraN1:s.ExtraN1,ExtraN2:0,ExtraN3:0,UpdatePayment:false,MostRecent:true,Status:n,USDAmount:s.USDAmount,Charges:s.Charges,Exchange:s.Exchange,SettleAmount:s.SettleAmount};var u=new sap.ui.model.Filter("StudentId","EQ","'"+this.customerId+"'");var d=new sap.ui.model.Filter("PartialPayment","EQ",true);a.ODataHelper.callOData(a.getOwnerComponent().getModel(),"/Subs","GET",{filters:[u,d]},{},a).then(function(e){if(e.results.length>0){MessageBox.error("Payment Pending for previous course")}else{if(!a.isDefaulter){a.getView().setBusy(true);a.ODataHelper.callOData(a.getOwnerComponent().getModel(),"/Subs","POST",{},g,a).then(function(e){a.getView().setBusy(false);a.subsciptionSaved="true";sap.m.MessageToast.show("Subscription Saved successfully");a.destroyMessagePopover()}).catch(function(e){a.getView().setBusy(false);a.subsciptionSaved="false";var t=a.getErrorMessage(e)})}else{sap.m.MessageToast.show("Student is defaulter")}}}).catch(function(e){})},onStartChange:function(e){var t=e.getSource().getValue();var a=t.split(".");var s=new Date(a[2],a[1]-1,a[0]);var i=this.formatter.getIncrementDate(s,8);this.getView().getModel("local").setProperty("/newRegistration/EndDate",i)},onPayDateChange:function(e){var t=e.getSource().getValue();var a=t.split(".");var s=new Date(a[2],a[1]-1,a[0]);var i=new Date(a[2],a[1]-1,a[0]);var r=this.formatter.getIncrementDate(s,1);this.getView().getModel("local").setProperty("/newRegistration/PaymentDueDate",r);i.setHours(0,0,0,0);var o=new sap.ui.model.Sorter("CreatedOn",true);var l=new sap.ui.model.Filter("PaymentDate","GE",i);var n=this.getView().byId("idSubsRecent");var g=n.getItems();n.getBinding("items").filter(l);n.getBinding("items").sort(o)},herculis:function(e){if(e.getParameter("name")!=="newreg"){return}var t=new Date;t.setHours(0,0,0,0);var a=new sap.ui.model.Sorter("CreatedOn",true);var s=this.getView().byId("idSubsRecent");var i=s.getItems();var r=new sap.ui.model.Filter("PaymentDate","GE",t);s.getBinding("items").filter(r);s.getBinding("items").sort(a);this.getView().getModel("local").setProperty("/newRegistration/StartDate",this.formatter.getFormattedDate(0));this.getView().getModel("local").setProperty("/newRegistration/PaymentDate",this.formatter.getFormattedDate(0));this.getView().getModel("local").setProperty("/newRegistration/EndDate",this.formatter.getFormattedDate(8));this.getView().getModel("local").setProperty("/newRegistration/PaymentDueDate",this.formatter.getFormattedDate(1));this.getView().getModel("local").setProperty("/newRegistration/StudentId",null);this.getView().getModel("local").setProperty("/newRegistration/CourseId",null);this.getView().getModel("local").setProperty("/newRegistration/Mode","L");this.getView().getModel("local").setProperty("/newRegistration/PaymentMode","IMPS");this.getView().getModel("local").setProperty("/newRegistration/AccountName",null);this.getView().getModel("local").setProperty("/newRegistration/Amount",15e3);this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",0);this.getView().getModel("local").setProperty("/newRegistration/PartialPayment",false);this.getView().getModel("local").setProperty("/newRegistration/Reference",null);this.getView().getModel("local").setProperty("/newRegistration/Extra2",null);this.getView().getModel("local").setProperty("/newRegistration/Waiver",false);this.getView().getModel("local").setProperty("/newRegistration/Waiver",false);this.getView().getModel("local").setProperty("/newRegistration/Waiver",false);this.getView().getModel("local").setProperty("/newCustomer/GmailId",null);this.getView().getModel("local").setProperty("/newCustomer/Name",null);this.getView().getModel("local").setProperty("/newCustomer/Country","IN");this.getView().getModel("local").setProperty("/newCustomer/ContactNo",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail1",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail2",null);this.getView().getModel("local").setProperty("/newCustomer/Skills",null);this.getView().getModel("local").setProperty("/newCustomer/Star",false);this.getView().getModel("local").setProperty("/newCustomer/Defaulter",false)},oSuppPopup:null,onCustomer:function(){if(!this.oSuppPopup){this.oSuppPopup=new sap.ui.xmlfragment("oft.fiori.fragments.newCustomer",this);sap.ui.getCore().getMessageManager().registerObject(this.oSuppPopup,true);this.getView().addDependent(this.oSuppPopup);this.oSuppPopup.setTitle("New Customer")}this.getView().getModel("local").setProperty("/newCustomer/GmailId",null);this.getView().getModel("local").setProperty("/newCustomer/Name",null);this.getView().getModel("local").setProperty("/newCustomer/Country","IN");this.getView().getModel("local").setProperty("/newCustomer/ContactNo",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail1",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail2",null);this.getView().getModel("local").setProperty("/newCustomer/Skills",null);this.getView().getModel("local").setProperty("/newCustomer/Star",false);this.getView().getModel("local").setProperty("/newCustomer/Defaulter",false);this.getView().getModel("local").setProperty("/newCustomer/HighServerUsage",false);sap.ui.getCore().byId("idSkills").clearSelection();this.oSuppPopup.open()},onUpdateFinished:function(e){var t=this.getView().byId("idSubsRecent");var a=t.getItems();var s=a.length;var i;var r;var o;var l=this.getView().getModel("local").getProperty("/Role");if(l==="Admin"){var n=0;for(var g=0;g<a.length;g++){n=n+parseInt(a[g].getCells()[6].getText())}t.getHeaderToolbar().getContent()[0].setText("Today : "+s+"  Amount:"+n)}else{t.getHeaderToolbar().getContent()[0].setText("Today : "+s)}var u=[];for(var g=0;g<s;g++){var d=a[g].getCells()[1].getText();var c="Courses('"+d+"')";var p=this.getView().getModel().oData[c];if(p){var m=p.BatchNo+": "+p.Name;a[g].getCells()[1].setText(m);a[g].getCells()[8].setEnabled(Boolean(p.Link&&p.Link.includes("anubhavtrainings")))}if(a[g].getCells()[0].getText().indexOf("@")===-1){u.push(a[g].getCells()[0].getText())}var h=a[g].getCells()[2].getItems()[0].getText();if(h=="Approved"){a[g].getCells()[2].getItems()[0].setText("Send Mail");a[g].getCells()[2].getItems()[0].setEnabled(true);a[g].getCells()[2].getItems()[0].setType(sap.m.ButtonType.Unstyled)}else if(h=="Pending"){if(this.UserRole=="Admin"){a[g].getCells()[2].getItems()[0].setText("Approve");a[g].getCells()[2].getItems()[0].setType(sap.m.ButtonType.Reject)}else{a[g].getCells()[2].getItems()[0].setEnabled(false);a[g].getCells()[2].getItems()[0].setType(sap.m.ButtonType.Reject)}}else if(h=="Access Granted"||h=="Access granted"||h=="access Granted"||h=="access granted"){a[g].getCells()[2].getItems()[0].setEnabled(false);a[g].getCells()[2].getItems()[0].setType(sap.m.ButtonType.Accept)}o=a[g].getCells().length-2;r=a[g].getCells()[4].getText();if(this.getModel("local").getProperty("/AppUsers")[r]){i=this.getModel("local").getProperty("/AppUsers")[r].UserName}if(i){a[g].getCells()[4].setText(i)}}if(u){var y={allStudents:u};$.post("/getAllStudents",y).done(function(e,t){for(var i=0;i<s;i++){var r=a[i].getCells()[0].getText();for(var o=0;o<e.length;o++){if(e[o].id===r){try{a[i].getCells()[0].setText(e[o].GmailId)}catch(e){}finally{}}}}}).fail(function(e,t,a){sap.m.MessageBox.error("Login Failed, Please enter correct credentials")})}},passwords:"",copyToClipboard:function(text,extra1){try{var texts=eval(text)}catch(e){var texts=text}finally{}if(window.clipboardData&&window.clipboardData.setData){clipboardData.setData("Text",texts);return window.open(extra1)}else if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var textarea=document.createElement("textarea");textarea.textContent=texts;textarea.style.position="fixed";document.body.appendChild(textarea);textarea.select();textarea.setSelectionRange(0,99999);try{document.execCommand("copy");return window.open(extra1)}catch(e){console.warn("Copy to clipboard failed.",e);return window.open(extra1)}finally{document.body.removeChild(textarea)}}},onBank:function(e){this.oEvent_approve=e;var t=e.getSource().getBindingContext().sPath;var a=this;var s=a.oEvent_approve.getSource().getBindingContext().getModel().getProperty(a.oEvent_approve.getSource().getBindingContext().getPath());if(s.AccountName){this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Accounts","GET",{filters:[new sap.ui.model.Filter("accountNo","EQ",s.AccountName)]},{},this).then(function(e){console.log(e.results[0].userId);console.log(e.results[0].key);try{debugger;a.copyToClipboard(e.results[0].userId,e.results[0].extra1)}catch(e){}finally{}}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})}},onApprove:function(e){this.oEvent_approve=e;if(e.getSource().getText()=="Approve"){var t=e.getSource().getBindingContext().sPath;var a=this;var s={Status:"Approved"};this.ODataHelper.callOData(this.getOwnerComponent().getModel(),t,"PUT",{},s,this).then(function(e){}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})}else if(e.getSource().getText()=="Send Mail"){var t=e.getSource().getBindingContext().sPath;var a=this;var s={Status:"Access Granted"};var i=a.oEvent_approve.getSource().getBindingContext().getModel().getProperty(a.oEvent_approve.getSource().getBindingContext().getPath());i.password="";i.includeX=a.getView().byId("includeX").getSelected();console.log(i.Member);$.post("/sendSubscriptionEmail",i).done(function(e,t){sap.m.MessageToast.show("Email sent successfully")}).fail(function(e,t,a){sap.m.MessageBox.error("Login Failed, Please enter correct credentials")});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),t,"PUT",{},s,this).then(function(e){}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})}},onSelect:function(e){this.sId=e.getSource().getId();var t="",a="";if(this.sId.indexOf("customerId")!==-1){this.getCustomerPopup();var s=this.getView().getModel("i18n").getProperty("customer");this.searchPopup.setTitle(s);this.searchPopup.bindAggregation("items",{path:"/Students",template:new sap.m.DisplayListItem({label:"{Name} {=${Defaulter} ? '(Defaulter)' : ''}",value:"{GmailId}"})})}else if(this.sId.indexOf("idEmailCust")!==-1){this.getCustomerPopup();var s=this.getView().getModel("i18n").getProperty("customer");this.searchPopup.setTitle(s);this.searchPopup.bindAggregation("items",{path:"/Inquries",template:new sap.m.DisplayListItem({label:"{EmailId}",value:"{FirstName}"})})}else if(this.sId.indexOf("courseId")!==-1){var i=new sap.ui.model.Filter("hidden",FilterOperator.EQ,false);this.getCustomerPopup();var s=this.getView().getModel("i18n").getProperty("batch");this.searchPopup.setTitle(s);this.searchPopup.bindAggregation("items",{path:"/Courses",filters:[i],sorter:{path:"EndDate",descending:false,group:false},template:new sap.m.ObjectListItem({title:"{Name}",intro:"{BatchNo}",number:{path:"status",formatter:this.formatter.formatStatusValue}})});var r=this.searchPopup.getBinding("items");var o=[];var l="EndDate";var n=true;o.push(new sap.ui.model.Sorter(l,n));r.sort(o)}else if(this.sId.indexOf("accountDetails")!==-1){var g=new sap.ui.model.Filter("deleted",FilterOperator.EQ,false);t="Account Search";a="local>/accountSet";this.getCustomerPopup();var s="Account Search";var u=new sap.ui.model.Sorter({path:"value",descending:false});this.searchPopup.setTitle(s);this.searchPopup.bindAggregation("items",{path:"local>/accountSet",filters:[g],sorter:u,template:new sap.m.DisplayListItem({label:"{local>value}",value:"{local>key}"})})}},onConfirm:function(e){if(this.sId.indexOf("accountDetails")!==-1){var t=e.getParameter("selectedItem").getValue();this.getView().getModel("local").setProperty("/newRegistration/AccountName",t)}else if(this.sId.indexOf("customerId")!==-1){var a=this.getSelectedKey(e);this.getView().byId("customerId").setValue(a[0]);this.isDefaulter=a[1].endsWith("(Defaulter)");this.customerId=a[2]}else if(this.sId.indexOf("courseId")!==-1){var a=this.getObjListSelectedkey(e);this.getView().byId("idCourseName").setText(a[0]);this.getView().byId("courseId").setValue(a[1]);this.courseId=a[3];var s=e.getParameter("selectedItem");var i=s.getBindingContext();if(i.getObject().Fee){this.getView().byId("idAmount").setValue(i.getObject().Fee);CourseFee=i.getObject().Fee}else{CourseFee=0}var r=new Date(i.getObject().DemoStartDate);r.setMonth(r.getMonth()+1);if(r>new Date){this.getView().byId("idPayDueDate").setDateValue(r)}}else if(this.sId.indexOf("idEmailCust")!==-1){var s=e.getParameter("selectedItem");var i=s.getBindingContext();sap.ui.getCore().byId("idSkills").clearSelection();sap.ui.getCore().byId("idPhone").setValue(0);sap.ui.getCore().byId("idCountry").setSelectedKey("IN");sap.ui.getCore().byId("idOtherEmail1").setValue(null);sap.ui.getCore().byId("idOtherEmail2").setValue(null);sap.ui.getCore().byId("idStar").setSelected(false);sap.ui.getCore().byId("idName").setValue(null);sap.ui.getCore().byId("idDefaulter").setSelected(false);sap.ui.getCore().byId("idHighServerUsage").setSelected(false);if(i){var o=this;var l={};var n=new sap.ui.model.Filter("GmailId","EQ",i.getObject().EmailId);this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[n]},l,this).then(function(e){if(e.results.length!=0){sap.ui.getCore().byId("idEmailCust").setValue(e.results[0].GmailId);sap.ui.getCore().byId("idName").setValue(e.results[0].Name);if(e.results[0].ContactNo){sap.ui.getCore().byId("idPhone").setValue(e.results[0].ContactNo)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(e.results[0].Country){sap.ui.getCore().byId("idCountry").setSelectedKey(e.results[0].Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}if(e.results[0].OtherEmail1){sap.ui.getCore().byId("idOtherEmail1").setValue(e.results[0].OtherEmail1)}if(e.results[0].OtherEmail2){sap.ui.getCore().byId("idOtherEmail2").setValue(e.results[0].OtherEmail2)}if(e.results[0].Defaulter){sap.ui.getCore().byId("idDefaulter").setSelected(e.results[0].Defaulter)}if(e.results[0].HighServerUsage){sap.ui.getCore().byId("idHighServerUsage").setSelected(e.results[0].HighServerUsage)}if(e.results[0].Star){sap.ui.getCore().byId("idStar").setSelected(e.results[0].Star)}sap.ui.getCore().byId("createNew").setText("Update");o.UpdateCustomer=true;o.customerGUID=e.results[0].id}else{var t;var a;sap.ui.getCore().byId("idEmailCust").setValue(i.getObject().EmailId);if(i.getObject().FirstName){if(i.getObject().LastName){t=i.getObject().LastName}else{t=" "}sap.ui.getCore().byId("idName").setValue(i.getObject().FirstName+" "+t)}else{a="";if(i.getObject().LastName){t=i.getObject().LastName}else{t=""}sap.ui.getCore().byId("idName").setValue(a+" "+t)}if(i.getObject().Phone){sap.ui.getCore().byId("idPhone").setValue(i.getObject().Phone)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(i.getObject().Country){sap.ui.getCore().byId("idCountry").setSelectedKey(i.getObject().Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}sap.ui.getCore().byId("createNew").setText("Create");o.UpdateCustomer=false}}).catch(function(e){var t;var a;sap.ui.getCore().byId("idEmailCust").setValue(i.getObject().EmailId);if(i.getObject().FirstName){if(i.getObject().LastName){t=i.getObject().LastName}else{t=" "}sap.ui.getCore().byId("idName").setValue(i.getObject().FirstName+" "+t)}else{a="";if(i.getObject().LastName){t=i.getObject().LastName}else{t=""}sap.ui.getCore().byId("idName").setValue(a+" "+t)}if(i.getObject().Phone){sap.ui.getCore().byId("idPhone").setValue(i.getObject().Phone)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(i.getObject().Country){sap.ui.getCore().byId("idCountry").setSelectedKey(i.getObject().Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}sap.ui.getCore().byId("createNew").setText("Create");o.UpdateCustomer=false})}}},suggestionItemSelected:function(e){var t=e.getParameter("selectedItem");var a=t.getBindingContext();sap.ui.getCore().byId("idSkills").clearSelection();sap.ui.getCore().byId("idPhone").setValue(0);sap.ui.getCore().byId("idCountry").setSelectedKey("IN");sap.ui.getCore().byId("idOtherEmail1").setValue(null);sap.ui.getCore().byId("idOtherEmail2").setValue(null);sap.ui.getCore().byId("idStar").setSelected(false);sap.ui.getCore().byId("idName").setValue(null);sap.ui.getCore().byId("idDefaulter").setSelected(false);sap.ui.getCore().byId("idHighServerUsage").setSelected(false);if(a){var s=this;var i={};var r=new sap.ui.model.Filter("GmailId","EQ",a.getObject().EmailId);this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[r]},i,this).then(function(e){if(e.results.length!=0){sap.ui.getCore().byId("idEmailCust").setValue(e.results[0].GmailId);sap.ui.getCore().byId("idName").setValue(e.results[0].Name);if(e.results[0].ContactNo){sap.ui.getCore().byId("idPhone").setValue(e.results[0].ContactNo)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(e.results[0].Country){sap.ui.getCore().byId("idCountry").setSelectedKey(e.results[0].Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}if(e.results[0].OtherEmail1){sap.ui.getCore().byId("idOtherEmail1").setValue(e.results[0].OtherEmail1)}if(e.results[0].OtherEmail2){sap.ui.getCore().byId("idOtherEmail2").setValue(e.results[0].OtherEmail2)}if(e.results[0].Defaulter){sap.ui.getCore().byId("idDefaulter").setSelected(e.results[0].Defaulter)}if(e.results[0].HighServerUsage){sap.ui.getCore().byId("idHighServerUsage").setSelected(e.results[0].HighServerUsage)}if(e.results[0].Star){sap.ui.getCore().byId("idStar").setSelected(e.results[0].Star)}sap.ui.getCore().byId("createNew").setText("Update");s.UpdateCustomer=true;s.customerGUID=e.results[0].id}else{var t;var i;sap.ui.getCore().byId("idEmailCust").setValue(a.getObject().EmailId);if(a.getObject().FirstName){if(a.getObject().LastName){t=a.getObject().LastName}else{t=" "}sap.ui.getCore().byId("idName").setValue(a.getObject().FirstName+" "+t)}else{i="";if(a.getObject().LastName){t=a.getObject().LastName}else{t=""}sap.ui.getCore().byId("idName").setValue(i+" "+t)}if(a.getObject().Phone){sap.ui.getCore().byId("idPhone").setValue(a.getObject().Phone)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(a.getObject().Country){sap.ui.getCore().byId("idCountry").setSelectedKey(a.getObject().Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}sap.ui.getCore().byId("createNew").setText("Create");s.UpdateCustomer=false}}).catch(function(e){var t;var i;sap.ui.getCore().byId("idEmailCust").setValue(a.getObject().EmailId);if(a.getObject().FirstName){if(a.getObject().LastName){t=a.getObject().LastName}else{t=" "}sap.ui.getCore().byId("idName").setValue(a.getObject().FirstName+" "+t)}else{i="";if(a.getObject().LastName){t=a.getObject().LastName}else{t=""}sap.ui.getCore().byId("idName").setValue(i+" "+t)}if(a.getObject().Phone){sap.ui.getCore().byId("idPhone").setValue(a.getObject().Phone)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(a.getObject().Country){sap.ui.getCore().byId("idCountry").setSelectedKey(a.getObject().Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}sap.ui.getCore().byId("createNew").setText("Create");s.UpdateCustomer=false})}},onAmountChange:function(e){var t=parseInt(e.getParameter("value"));if(t<CourseFee){var a=CourseFee-t;this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",a);this.getView().getModel("local").setProperty("/newRegistration/PartialPayment",true)}else{this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",0);this.getView().getModel("local").setProperty("/newRegistration/PartialPayment",false)}},onWaiver:function(e){var t=e.getParameter("selected");if(t===true){this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",0);this.getView().getModel("local").setProperty("/newRegistration/PartialPayment",false)}else{var a=this.getView().getModel("local").getProperty("/newRegistration/Amount");if(a<CourseFee){var s=CourseFee-a;this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",s);this.getView().getModel("local").setProperty("/newRegistration/PartialPayment",true)}else{this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",0);this.getView().getModel("local").setProperty("/newRegistration/PartialPayment",false)}}},onSearch:function(e){if(this.sId.indexOf("customerId")!==-1){var t=this.getQuery(e);if(t){var a=new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("GmailId",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a,s],and:false});var r=[i];this.searchPopup.getBinding("items").filter(r)}else{this.searchPopup.bindAggregation("items",{path:"/Students",template:new sap.m.DisplayListItem({label:"{Name}",value:"{GmailId}"})});this.searchPopup.getBinding("items").filter([])}}else if(this.sId.indexOf("courseId")!==-1){var t=this.getQuery(e);if(t){var a=new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("BatchNo",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a,s],and:false});var r=[i];this.searchPopup.getBinding("items").filter(r)}else{this.searchPopup.bindAggregation("items",{path:"/Courses",template:new sap.m.DisplayListItem({label:"{Name}",value:"{BatchNo}"})});this.searchPopup.getBinding("items").filter([])}}},onCancel:function(e){this.searchPopup.close()},onClose:function(){this.oSuppPopup.close()},onCreateCust:function(e){var t=e;var a=this;a.getView().setBusy(true);var s=this.getView().getModel("local").getProperty("/newCustomer");var i=sap.ui.getCore().byId("idFileUploader");var r=i.getFocusDomRef();var o=r.files[0];if(o){var a=this;var l=o.name.split(".");var n=l.length;var g=o.type.split("/")[1];var u=l[n-1];if(u=="PDF"||u=="DOCX"||u=="DOC"||u=="pdf"||u=="docx"||u=="doc"||u=="msword"||u=="MSWORD"){var d=new FileReader;d.onload=function(e){if(u=="PDF"||u=="pdf"){a.FileContent=e.currentTarget.result.replace("data:application/pdf;base64,","")}else{if(g=="msword"){a.FileContent=e.currentTarget.result.replace("data:application/msword;base64,","")}else{a.FileContent=e.currentTarget.result.replace("data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,","")}}};d.readAsDataURL(o)}else{sap.m.MessageToast.show("File Type should be PDF or DOC");return""}}if(a.UpdateCustomer==false){var c={GmailId:s.GmailId,Name:s.Name,CompanyMail:s.CompanyMail,Country:s.Country,Designation:s.Designation,OtherEmail1:s.OtherEmail1,OtherEmail2:s.OtherEmail2,ContactNo:s.ContactNo,Star:s.Star,Defaulter:s.Defaulter,HighServerUsage:s.HighServerUsage,Skills:s.Skills,Resume:this.FileContent,Extra1:"EExtra1",Extra2:"EExtra2",CreatedOn:new Date,CreatedBy:"DemoUser"};this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","POST",{},c,this).then(function(e){a.getView().setBusy(false);sap.m.MessageToast.show("Customer Saved successfully");a.destroyMessagePopover();a.oSuppPopup.close()}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})}else{var p=" ";if(s.Star==true){p="true"}else{p="false"}var m=" ";if(s.Defaulter==true){m="true"}else{m="false"}var h=" ";if(s.HighServerUsage==true){h="true"}else{h="false"}var c={GmailId:s.GmailId,Name:s.Name,CompanyMail:s.CompanyMail,Country:s.Country,Designation:s.Designation,OtherEmail1:s.OtherEmail1,OtherEmail2:s.OtherEmail2,ContactNo:s.ContactNo,Star:p,Defaulter:m,HighServerUsage:h,Skills:s.Skills,Resume:this.FileContent,Extra1:"EExtra1",Extra2:"EExtra2",ChangedOn:new Date,ChangedBy:"DemoUser"};var y="/Students";y=y+"("+"'"+a.customerGUID+"'"+")";this.ODataHelper.callOData(this.getOwnerComponent().getModel(),y,"PUT",{},c,this).then(function(e){a.getView().setBusy(false);sap.m.MessageToast.show("Customer updated successfully");a.destroyMessagePopover();a.oSuppPopup.close()}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})}},onLiveSearch:function(e){var t=e.getParameter("query");if(!t){t=e.getParameter("value")}if(this.sId.indexOf("customerId")!==-1){if(t){var a=new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("GmailId",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a,s],and:false});var r=[i];this.searchPopup.getBinding("items").filter(r)}else{this.searchPopup.bindAggregation("items",{path:"/Students",template:new sap.m.DisplayListItem({label:"{Name}",value:"{GmailId}"})});this.searchPopup.getBinding("items").filter([])}}else if(this.sId.indexOf("courseId")!==-1){if(t){var a=new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("BatchNo",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a,s],and:false});var r=[i];this.searchPopup.getBinding("items").filter(r)}else{this.searchPopup.bindAggregation("items",{path:"/Courses",template:new sap.m.DisplayListItem({label:"{Name}",value:"{BatchNo}"})});this.searchPopup.getBinding("items").filter([])}}else if(this.sId.indexOf("accountDetails")!==-1){if(t){var a=new sap.ui.model.Filter("value",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("key",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a,s],and:false});var r=[i];this.searchPopup.getBinding("items").filter(r)}else{this.searchPopup.bindAggregation("items",{path:"local>/accountSet",template:new sap.m.DisplayListItem({label:"{local>value}",value:"{local>key}"})});this.searchPopup.getBinding("items").filter([])}}else if(this.sId.indexOf("idEmailCust")!==-1){if(t){var a=new sap.ui.model.Filter("EmailId",sap.ui.model.FilterOperator.Contains,t);var s=new sap.ui.model.Filter("FirstName",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a,s],and:false});var r=[i];this.searchPopup.getBinding("items").filter(r)}else{this.searchPopup.bindAggregation("items",{path:"/Inquries",template:new sap.m.DisplayListItem({label:"{EmailId}",value:"{FirstName}"})});this.searchPopup.getBinding("items").filter([])}}},onClearScreen:function(e){this.getView().getModel("local").setProperty("/newRegistration/StartDate",this.formatter.getFormattedDate(0));this.getView().getModel("local").setProperty("/newRegistration/PaymentDate",this.formatter.getFormattedDate(0));this.getView().getModel("local").setProperty("/newRegistration/EndDate",this.formatter.getFormattedDate(8));this.getView().getModel("local").setProperty("/newRegistration/PaymentDueDate",this.formatter.getFormattedDate(1));this.getView().getModel("local").setProperty("/newRegistration/StudentId",null);this.getView().getModel("local").setProperty("/newRegistration/CourseId",null);this.getView().getModel("local").setProperty("/newRegistration/Mode","L");this.getView().getModel("local").setProperty("/newRegistration/PaymentMode","IMPS");this.getView().getModel("local").setProperty("/newRegistration/AccountName",null);this.getView().getModel("local").setProperty("/newRegistration/Amount",15e3);this.getView().getModel("local").setProperty("/newRegistration/PendingAmount",0);this.getView().getModel("local").setProperty("/newRegistration/PartialPayment",false);this.getView().getModel("local").setProperty("/newRegistration/Reference",null);this.getView().getModel("local").setProperty("/newRegistration/Extra2",null);this.getView().getModel("local").setProperty("/newRegistration/Waiver",false);this.getView().getModel("local").setProperty("/newRegistration/USDAmount",0);this.getView().getModel("local").setProperty("/newRegistration/Charges",0);this.getView().getModel("local").setProperty("/newRegistration/Exchange",73.25);this.getView().getModel("local").setProperty("/newRegistration/SettleAmount",0);this.getView().getModel("local").setProperty("/newCustomer/GmailId",null);this.getView().getModel("local").setProperty("/newCustomer/Name",null);this.getView().getModel("local").setProperty("/newCustomer/Country","IN");this.getView().getModel("local").setProperty("/newCustomer/ContactNo",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail1",null);this.getView().getModel("local").setProperty("/newCustomer/OtherEmail2",null);this.getView().getModel("local").setProperty("/newCustomer/Skills",null);this.getView().getModel("local").setProperty("/newCustomer/Star",false);this.getView().getModel("local").setProperty("/newCustomer/Defaulter",false);this.getView().byId("imageUploader").clear()},handleSkillChange:function(e){},handleSkillFinish:function(e){var t=e.getParameter("selectedItems");var a=" ";for(var s=0;s<t.length;s++){a+=t[s].getText();if(s!=t.length-1){a+=","}}this.getView().getModel("local").setProperty("/newCustomer/Skills",a)},onEmail:function(e){sap.ui.getCore().byId("idName").setEnabled(true)},onEmailExist:function(e){var t=e;var a=this;var s=this.getView().getModel("local").getProperty("/newCustomer");var i={};if(s.GmailId){var r=new sap.ui.model.Filter("GmailId","EQ",s.GmailId);this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[r]},i,this).then(function(e){if(e.results.length!=0){sap.ui.getCore().byId("createNew").setText("Update");a.UpdateCustomer=true;a.customerGUID=e.results[0].id;sap.m.MessageToast.show("Email Exists. Use F4 help or Use suggestion on Email field to fetch values")}else{sap.ui.getCore().byId("createNew").setText("Create");a.UpdateCustomer=false}}).catch(function(e){sap.m.MessageToast.show("New Customer");sap.ui.getCore().byId("createNew").setText("Create");a.UpdateCustomer=false})}else{sap.ui.getCore().byId("idName").setEnabled(false);sap.m.MessageToast.show("Enter/select email id first")}},onEnter:function(e){vEmail=e.getParameters().value;var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;sap.ui.getCore().byId("idSkills").clearSelection();sap.ui.getCore().byId("idPhone").setValue(0);sap.ui.getCore().byId("idCountry").setSelectedKey("IN");sap.ui.getCore().byId("idOtherEmail1").setValue(null);sap.ui.getCore().byId("idOtherEmail2").setValue(null);sap.ui.getCore().byId("idStar").setSelected(false);sap.ui.getCore().byId("idName").setValue(null);sap.ui.getCore().byId("idDefaulter").setSelected(false);sap.ui.getCore().byId("idHighServerUsage").setSelected(false);if(t.test(vEmail)){var a=this;var s={};var i=new sap.ui.model.Filter("GmailId","EQ",vEmail);this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Students","GET",{filters:[i]},s,this).then(function(e){if(e.results.length!=0){sap.ui.getCore().byId("idEmailCust").setValue(e.results[0].GmailId);sap.ui.getCore().byId("idName").setValue(e.results[0].Name);if(e.results[0].ContactNo){sap.ui.getCore().byId("idPhone").setValue(e.results[0].ContactNo)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(e.results[0].Country){sap.ui.getCore().byId("idCountry").setSelectedKey(e.results[0].Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}if(e.results[0].OtherEmail1){sap.ui.getCore().byId("idOtherEmail1").setValue(e.results[0].OtherEmail1)}if(e.results[0].OtherEmail2){sap.ui.getCore().byId("idOtherEmail2").setValue(e.results[0].OtherEmail2)}if(e.results[0].Defaulter){sap.ui.getCore().byId("idDefaulter").setSelected(e.results[0].Defaulter)}if(e.results[0].HighServerUsage){sap.ui.getCore().byId("idHighServerUsage").setSelected(e.results[0].HighServerUsage)}if(e.results[0].Star){sap.ui.getCore().byId("idStar").setSelected(e.results[0].Star)}sap.ui.getCore().byId("createNew").setText("Update");a.UpdateCustomer=true;a.customerGUID=e.results[0].id}else{var t;var s;var i=a;var r={};var o=new sap.ui.model.Filter("EmailId","EQ",a.vEmail);a.ODataHelper.callOData(a.getOwnerComponent().getModel(),"/Inquries","GET",{filters:[o]},r,a).then(function(e){if(e.results.length!=0){sap.ui.getCore().byId("idEmailCust").setValue(e.results[0].EmailId);sap.ui.getCore().byId("idName").setValue(e.results[0].Name);if(e.results[0].FirstName){if(e.results[0].LastName){t=e.results[0].LastName}else{t=" "}sap.ui.getCore().byId("idName").setValue(e.results[0].FirstName+" "+t)}else{s="";if(e.results[0].LastName){t=e.results[0].LastName}else{t=""}sap.ui.getCore().byId("idName").setValue(s+" "+t)}if(e.results[0].Phone){sap.ui.getCore().byId("idPhone").setValue(e.results[0].Phone)}else{sap.ui.getCore().byId("idPhone").setValue(0)}if(e.results[0].Country){sap.ui.getCore().byId("idCountry").setSelectedKey(e.results[0].Country)}else{sap.ui.getCore().byId("idCountry").setSelectedKey("IN")}sap.ui.getCore().byId("createNew").setText("Create");i.UpdateCustomer=false}else{sap.ui.getCore().byId("createNew").setText("Create");i.UpdateCustomer=false}}).catch(function(e){var t=i.getErrorMessage(e)})}}).catch(function(e){var t=a.getErrorMessage(e)})}else{sap.m.MessageToast.show("Invalid email id");return""}},onUpload:function(e){}})});
//# sourceMappingURL=newReg.controller.js.map